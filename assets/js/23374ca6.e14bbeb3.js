"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[421],{3905:function(e,n,t){t.d(n,{Zo:function(){return u},kt:function(){return m}});var r=t(7294);function i(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function a(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function o(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?a(Object(t),!0).forEach((function(n){i(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):a(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function s(e,n){if(null==e)return{};var t,r,i=function(e,n){if(null==e)return{};var t,r,i={},a=Object.keys(e);for(r=0;r<a.length;r++)t=a[r],n.indexOf(t)>=0||(i[t]=e[t]);return i}(e,n);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)t=a[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(i[t]=e[t])}return i}var l=r.createContext({}),c=function(e){var n=r.useContext(l),t=n;return e&&(t="function"==typeof e?e(n):o(o({},n),e)),t},u=function(e){var n=c(e.components);return r.createElement(l.Provider,{value:n},e.children)},p={inlineCode:"code",wrapper:function(e){var n=e.children;return r.createElement(r.Fragment,{},n)}},d=r.forwardRef((function(e,n){var t=e.components,i=e.mdxType,a=e.originalType,l=e.parentName,u=s(e,["components","mdxType","originalType","parentName"]),d=c(t),m=i,g=d["".concat(l,".").concat(m)]||d[m]||p[m]||a;return t?r.createElement(g,o(o({ref:n},u),{},{components:t})):r.createElement(g,o({ref:n},u))}));function m(e,n){var t=arguments,i=n&&n.mdxType;if("string"==typeof e||i){var a=t.length,o=new Array(a);o[0]=d;var s={};for(var l in n)hasOwnProperty.call(n,l)&&(s[l]=n[l]);s.originalType=e,s.mdxType="string"==typeof e?e:i,o[1]=s;for(var c=2;c<a;c++)o[c]=t[c];return r.createElement.apply(null,o)}return r.createElement.apply(null,t)}d.displayName="MDXCreateElement"},6527:function(e,n,t){t.r(n),t.d(n,{assets:function(){return u},contentTitle:function(){return l},default:function(){return m},frontMatter:function(){return s},metadata:function(){return c},toc:function(){return p}});var r=t(7462),i=t(3366),a=(t(7294),t(3905)),o=["components"],s={},l=void 0,c={unversionedId:"README",id:"README",title:"README",description:"About Courier",source:"@site/docs/README.md",sourceDirName:".",slug:"/",permalink:"/courier-android/docs/",draft:!1,editUrl:"https://github.com/gojek/courier-android/edit/main/docs/docs/README.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",next:{title:"Courier Android - Contribution Guidelines",permalink:"/courier-android/docs/CONTRIBUTION"}},u={},p=[{value:"About Courier",id:"about-courier",level:2},{value:"Features",id:"features",level:2},{value:"Getting Started",id:"getting-started",level:2},{value:"Sample App",id:"sample-app",level:3},{value:"Download",id:"download",level:3},{value:"Usage",id:"usage",level:3},{value:"Subscribe/Unsubscribe using Service Interface",id:"subscribeunsubscribe-using-service-interface",level:3},{value:"Send/Receive using Service Interface",id:"sendreceive-using-service-interface",level:3},{value:"Connect using MqttClient",id:"connect-using-mqttclient",level:3},{value:"Disconnect using MqttClient",id:"disconnect-using-mqttclient",level:3},{value:"Contribution Guidelines",id:"contribution-guidelines",level:2},{value:"License",id:"license",level:2}],d={toc:p};function m(e){var n=e.components,t=(0,i.Z)(e,o);return(0,a.kt)("wrapper",(0,r.Z)({},d,t,{components:n,mdxType:"MDXLayout"}),(0,a.kt)("h2",{id:"about-courier"},"About Courier"),(0,a.kt)("p",null,"Courier is a kotlin library for creating long running connections using MQTT protocol."),(0,a.kt)("p",null,"Long running connection is a persistent connection established between client & server for instant bi-directional communication. A long running connection is maintained for maximum possible duration with the help of keep alive packets. This helps in saving battery and data on mobile devices."),(0,a.kt)("p",null,'MQTT is an extremely lightweight protocol which works on publish/subscribe messaging model. It is designed for connections with remote locations where a "small code footprint" is required or the network bandwidth is limited.'),(0,a.kt)("p",null,"The protocol usually runs over TCP/IP; however, any network protocol that provides ordered, lossless, bi-directional connections can support MQTT."),(0,a.kt)("p",null,"MQTT has 3 built-in QoS levels for Reliable Message Delivery:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},(0,a.kt)("strong",{parentName:"p"},"QoS 0(At most once)")," - the message is sent only once and the client and broker take no additional steps to acknowledge delivery (fire and forget).")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},(0,a.kt)("strong",{parentName:"p"},"QoS 1(At least once)")," - the message is re-tried by the sender multiple times until acknowledgement is received (acknowledged delivery).")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},(0,a.kt)("strong",{parentName:"p"},"QoS 2(Exactly once)")," - the sender and receiver engage in a two-level handshake to ensure only one copy of the message is received (assured delivery)."))),(0,a.kt)("h2",{id:"features"},"Features"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"Clean API")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"Adaptive Keep Alive")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"Message & Stream Adapters")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"Subscription Store")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"Automatic Reconnect & Resubscribe")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"Database Persistence")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"Backpressure handling")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"Alarm, Timer & WorkManager Ping Sender")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"MQTT Chuck"))),(0,a.kt)("p",null,"More details about features in Courier library can be found ",(0,a.kt)("a",{parentName:"p",href:"https://medium.com/gojekengineering/courier-library-for-gojeks-information-superhighway-368dc5f052fa"},"here")),(0,a.kt)("h2",{id:"getting-started"},"Getting Started"),(0,a.kt)("h3",{id:"sample-app"},"Sample App"),(0,a.kt)("p",null,"A demo application is added ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/gojek/courier-android/tree/main/app"},"here")," which makes Courier connection with a ",(0,a.kt)("a",{parentName:"p",href:"https://broker.mqttdashboard.com/"},"HiveMQ")," public broker."),(0,a.kt)("h3",{id:"download"},"Download"),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"https://search.maven.org/search?q=g:%22com.gojek.courier%22%20AND%20a:%25courier%22"},(0,a.kt)("img",{parentName:"a",src:"https://img.shields.io/maven-central/v/com.gojek.courier/courier.svg?label=Maven%20Central",alt:"Maven Central"}))),(0,a.kt)("p",null,"All artifacts of Courier library are available via Maven Central."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-groovy"},'repositories {\n    mavenCentral()\n}\n\ndependencies {\n    implementation "com.gojek.courier:courier:x.y.z"\n\n    implementation "com.gojek.courier:courier-message-adapter-gson:x.y.z"\n    implementation "com.gojek.courier:courier-stream-adapter-rxjava2:x.y.z"\n}\n')),(0,a.kt)("h3",{id:"usage"},"Usage"),(0,a.kt)("p",null,"Declare a service interface for actions like Send, Receive, Subscribe, Unsubscribe:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-kotlin"},'interface MessageService {\n    @Receive(topic = "topic/{id}/receive")\n    fun receive(@Path("id") identifier: String): Observable<Message>\n    \n    @Send(topic = "topic/{id}/send", qos = QoS.TWO)\n    fun send(@Path("id") identifier: String, @Data message: Message)\n    \n    @Subscribe(topic = "topic/{id}/receive", qos = QoS.ONE)\n    fun subscribe(@Path("id") identifier: String): Observable<Message>\n    \n    @Unsubscribe(topics = ["topic/{id}/receive"])\n    fun unsubscribe(@Path("id") identifier: String)\n}\n')),(0,a.kt)("p",null,"Use Courier to create an implementation:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-kotlin"},"val mqttClient = MqttClientFactory.create(\n    context = context,\n    mqttConfiguration = MqttV3Configuration(\n        authenticator = authenticator\n    )\n)\n\nval courierConfiguration = Courier.Configuration(\n    client = mqttClient,\n    streamAdapterFactories = listOf(RxJava2StreamAdapterFactory()),\n    messageAdapterFactories = listOf(GsonMessageAdapter.Factory())\n)\n\nval courier = Courier(courierConfiguration)\n\nval messageService = courier.create<MessageService>()\n")),(0,a.kt)("h3",{id:"subscribeunsubscribe-using-service-interface"},"Subscribe/Unsubscribe using Service Interface"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-kotlin"},'messageService.subscribe("user-id").subscribe { message ->\n    print(message)\n}\nmessageService.unsubscribe("user-id")\n')),(0,a.kt)("h3",{id:"sendreceive-using-service-interface"},"Send/Receive using Service Interface"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-kotlin"},'messageService.send("user-id", message)\nmessageService.receive("user-id") { message ->\n    print(message)\n}\n')),(0,a.kt)("h3",{id:"connect-using-mqttclient"},"Connect using MqttClient"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-kotlin"},"val connectOptions = MqttConnectOptions(\n    serverUris = listOf(ServerUri(SERVER_URI, SERVER_PORT)),\n    clientId = clientId,\n    username = username,\n    keepAlive = KeepAlive(\n        timeSeconds = keepAliveSeconds\n    ),\n    isCleanSession = cleanSessionFlag,\n    password = password\n)\n\nmqttClient.connect(connectOptions)\n")),(0,a.kt)("h3",{id:"disconnect-using-mqttclient"},"Disconnect using MqttClient"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-kotlin"},"mqttClient.disconnect()\n")),(0,a.kt)("h2",{id:"contribution-guidelines"},"Contribution Guidelines"),(0,a.kt)("p",null,"Read our ",(0,a.kt)("a",{parentName:"p",href:"CONTRIBUTION"},"contribution guide")," to learn about our development process, how to propose bugfixes and improvements, and how to build and test your changes to Courier Android library."),(0,a.kt)("h2",{id:"license"},"License"),(0,a.kt)("p",null,"All Courier modules except Paho are ",(0,a.kt)("a",{parentName:"p",href:"LICENSE"},"MIT Licensed"),". Paho is ",(0,a.kt)("a",{parentName:"p",href:"LICENSE.paho"},"Eclipse Licensed"),"."))}m.isMDXComponent=!0}}]);